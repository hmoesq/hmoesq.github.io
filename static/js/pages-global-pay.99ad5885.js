(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-global-pay"],{1406:function(t,a,e){"use strict";var i=e("14da"),n=e.n(i);n.a},"14da":function(t,a,e){var i=e("ac73");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=e("4f06").default;n("061084be",i,!0,{sourceMap:!1,shadowMode:!1})},6106:function(t,a,e){"use strict";e.r(a);var i=e("9121"),n=e("947d");for(var s in n)["default"].indexOf(s)<0&&function(t){e.d(a,t,(function(){return n[t]}))}(s);e("1406");var o=e("f0c5"),r=Object(o["a"])(n["default"],i["b"],i["c"],!1,null,"6ff79afb",null,!1,i["a"],void 0);a["default"]=r.exports},"7ed3":function(t,a,e){var i=e("23e7"),n=e("c65b"),s=e("825a"),o=e("861d"),r=e("c60d"),c=e("d039"),l=e("9bf2"),d=e("06cf"),p=e("e163"),u=e("5c6c");var y=c((function(){var t=function(){},a=l.f(new t,"a",{configurable:!0});return!1!==Reflect.set(t.prototype,"a",1,a)}));i({target:"Reflect",stat:!0,forced:y},{set:function t(a,e,i){var c,y,f,v=arguments.length<4?a:arguments[3],h=d.f(s(a),e);if(!h){if(o(y=p(a)))return t(y,e,i,v);h=u(0)}if(r(h)){if(!1===h.writable||!o(v))return!1;if(c=d.f(v,e)){if(c.get||c.set||!1===c.writable)return!1;c.value=i,l.f(v,e,c)}else l.f(v,e,u(0,i))}else{if(f=h.set,void 0===f)return!1;n(f,v,i)}return!0}})},9121:function(t,a,e){"use strict";e.d(a,"b",(function(){return i})),e.d(a,"c",(function(){return n})),e.d(a,"a",(function(){}));var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-uni-view",{staticClass:"pay-page"},[e("v-uni-view",{staticClass:"pay-time fs16"},[0==t.time?[e("v-uni-text",[t._v("订单支付超时，请重新发起支付")])]:[e("b2font",{attrs:{type:"b2time-line",size:"40"}}),e("v-uni-text",[t._v("支付剩余时间：")]),e("v-uni-text",{domProps:{textContent:t._s(t.time.minute)}}),t._v(":"),e("v-uni-text",{domProps:{textContent:t._s(t.time.second)}})]],2),e("v-uni-view",{staticClass:"pay-info fs16"},[e("v-uni-view",{staticClass:"pay-title lin-1 pay-row"},[e("v-uni-text",{staticClass:"gray"},[t._v("订单名称：")]),t._v(t._s(t.$decode(t.payData.title)))],1),e("v-uni-view",{staticClass:"pay-meta pay-row"}),e("v-uni-view",{staticClass:"pay-type-info pay-row"},[e("v-uni-text",{staticClass:"gray"},[t._v("订单类型：")]),t._v(t._s(t.type))],1),e("v-uni-view",{staticClass:"pay-money pay-row"},[e("v-uni-text",{staticClass:"gray"},[t._v("订单金额：")]),t._v(t._s(t.symbol+t.payData.order_price))],1),e("v-uni-view",{staticClass:"circle-box"},t._l(20,(function(t,a){return e("v-uni-view",{key:a,staticClass:"bottom-circle"})})),1)],1),e("v-uni-view",{staticClass:"pay-type fs16"},[e("v-uni-radio-group",{on:{change:function(a){arguments[0]=a=t.$handleEvent(a),t.radioChange.apply(void 0,arguments)}}},[t.allowPay.balance&&t.token&&"cz"!=t.payData.order_type?e("v-uni-label",{staticClass:"uni-list-cell uni-list-cell-pd"},[e("v-uni-view",{staticClass:"balance pay-type-item"},[e("v-uni-view",{staticClass:"flex-center"},[e("b2font",{attrs:{type:"b2rmb",size:"30",color:"#fff"}}),e("v-uni-view",{staticClass:"b-payinfo"},[e("v-uni-text",[t._v(t._s(t.opt.money_name)+"支付")]),e("v-uni-text",{staticClass:"fs12 gray"},[t._v("您当前的"+t._s(t.opt.money_name)+"为："+t._s(t.symbol+t.allowPay.money))])],1)],1),e("v-uni-radio",{attrs:{value:"balance",checked:"balance"===t.picked}})],1)],1):t._e(),t.allowPay.wecatpay&&t.payment.includes("wxpay")?e("v-uni-label",{staticClass:"uni-list-cell uni-list-cell-pd"},[e("v-uni-view",{staticClass:"balance pay-type-item"},[e("v-uni-view",{staticClass:"flex-center"},[e("b2font",{attrs:{type:"b2wechat-pay-fill",size:"50",color:"#00c800"}}),e("v-uni-view",{staticClass:"b-payinfo"},[e("v-uni-text",[t._v("微信支付")]),e("v-uni-text",{staticClass:"fs12 gray"},[t._v("安全、便捷、专业的在线支付服务")])],1)],1),e("v-uni-radio",{attrs:{value:"wecatpay",checked:"wecatpay"===t.picked}})],1)],1):t._e(),t.allowPay.alipay&&t.payment.includes("alipay")?e("v-uni-label",{staticClass:"uni-list-cell uni-list-cell-pd"},[e("v-uni-view",{staticClass:"balance pay-type-item"},[e("v-uni-view",{staticClass:"flex-center"},[e("b2font",{attrs:{type:"b2alipay-fill",size:"50",color:"#00a0e9"}}),e("v-uni-view",{staticClass:"b-payinfo"},[e("v-uni-text",[t._v("支付宝支付")]),e("v-uni-text",{staticClass:"fs12 gray"},[t._v("安全、便捷、专业的在线支付服务")])],1)],1),e("v-uni-radio",{attrs:{value:"alipay",checked:"alipay"===t.picked}})],1)],1):t._e()],1)],1),e("v-uni-view",{staticClass:"pay-button mg-t"},[e("v-uni-button",{attrs:{disabled:t.locked},on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.pay.apply(void 0,arguments)}}},[t._v("确认支付")])],1)],1)},n=[]},"947d":function(t,a,e){"use strict";e.r(a);var i=e("d50d"),n=e.n(i);for(var s in i)["default"].indexOf(s)<0&&function(t){e.d(a,t,(function(){return i[t]}))}(s);a["default"]=n.a},ac73:function(t,a,e){var i=e("24fb");a=i(!1),a.push([t.i,".b-payinfo[data-v-6ff79afb]{display:flex;flex-flow:column}.pay-type .b2rmb[data-v-6ff79afb]{background-color:#f16b6f;border-radius:100%;width:%?44?%;height:%?44?%;text-align:center;line-height:%?44?%}.uni-list-cell + .uni-list-cell .pay-type-item[data-v-6ff79afb]{border-top:1px solid #efefef}.pay-type-item[data-v-6ff79afb]{padding:%?40?% %?60?%;align-items:center;justify-content:space-between}.pay-row[data-v-6ff79afb]{margin-bottom:%?20?%}.pay-type .b2font[data-v-6ff79afb]{margin-right:%?10?%}.circle-box[data-v-6ff79afb]{position:absolute;bottom:%?-8?%;width:100%;display:flex;left:0}.bottom-circle[data-v-6ff79afb]{border-radius:100%;height:%?20?%;width:%?20?%;background-color:#fff;margin:0 %?10?%}.pay-time[data-v-6ff79afb]{background-color:#7d8590;height:%?100?%;display:flex;align-items:center;justify-content:center;color:#fff}.pay-page[data-v-6ff79afb]{background-color:#eee;height:100vh}.pay-time .b2time-line[data-v-6ff79afb]{margin-right:%?10?%}.pay-info[data-v-6ff79afb]{padding:%?60?%;background-color:#fff;position:relative}.pay-type[data-v-6ff79afb]{margin-top:%?40?%;margin-bottom:%?40?%;background-color:#fff;border-top:1px solid #efefef}.pay-type-item[data-v-6ff79afb]{display:flex;align-items:center}.pay-button[data-v-6ff79afb]{margin:0 %?20?%;margin-top:%?24?%}",""]),t.exports=a},d50d:function(t,a,e){"use strict";(function(t){e("7a82"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,e("ac1f"),e("5319"),e("7ed3"),e("d3b7"),e("f8c9");var i={data:function(){return{payData:{},time:{minute:30,second:0},picked:"",type:"",allowPay:{alipay:!1,balance:!1,card:!1,money:0,paypal:!1,wecatpay:!1},locked:!1,timeOut:null,countCheck:0}},computed:{symbol:function(){return this.$store.state.opt.symbol},opt:function(){return this.$store.state.opt},token:function(){return this.$store.state.token},payment:function(){return this.$store.state.payment}},onLoad:function(t){if(this.payData=t,"w"==this.payData.order_type&&(this.type="查看隐藏内容"),"x"==this.payData.order_type&&(this.type="资源下载"),"g"==this.payData.order_type&&(this.type="购买"),"cz"==this.payData.order_type&&(this.type="充值"),"v"==this.payData.order_type&&(this.type="购买视频"),"circle_hidden_content_pay"==this.payData.order_type&&(this.type="查看隐藏帖子"),"vip"==this.payData.order_type&&(this.type="VIP购买"),"cg"==this.payData.order_type&&(this.type="积分购买"),"infomation_sticky"==this.payData.order_type&&(this.type="置顶"),1==this.payData.paycheck){var a=uni.getStorageSync("order_id").replace(/\"/g,"");a&&this.payCheck(a)}uni.hideLoading(),this.getAllowPay(),this.timeRow()},methods:{buildOrder:function(){var a=this;uni.showLoading({title:"支付中..."}),uni.request({method:"post",url:this.$store.state.restUrlNormal+"buildOrder",header:this.$store.state.headerToken,data:{title:this.payData.title,order_price:this.payData.order_price,order_type:this.payData.order_type,order_key:this.payData.order_key,post_id:this.payData.post_id?this.payData.post_id:0,pay_type:this.picked,order_value:this.payData.order_value,redirect_url:window.location.href+"&paycheck=1",order_mobile:"alipay"==this.picked?"alipayH5":""},success:function(e){t.log(e),403==e.statusCode?(uni.hideLoading(),uni.showModal({content:e.data.message,showCancel:!1})):(uni.setStorageSync("order_id",e.data.id),"balance"==a.picked?uni.request({method:"post",url:a.$store.state.restUrlNormal+"balancePay",header:a.$store.state.headerToken,data:{order_id:e.data},success:function(t){403==t.statusCode?(uni.hideLoading(),uni.showModal({content:t.data.message,showCancel:!1})):a.payCheck(e.data)}}):(window.location.href=e.data.url,a.payCheck(e.data.id)))}})},payCheck:function(t){var a=this;if(this.countCheck++,this.countCheck>=60)return this.timeOut=null,uni.showModal({content:"支付失败",showCancel:!1}),void(this.countCheck=0);this.timeOut=null,uni.request({method:"post",url:this.$store.state.restUrlNormal+"payCheck",header:this.$store.state.headerToken,data:{order_id:t},success:function(e){if("success"==e.data.status){if(a.getCurrentUserInfo(),a.timeOut=null,uni.hideLoading(),!a.token){var i=uni.getStorageSync("b2_guest_buy_"+e.data.id+"_"+e.data.type);Reflect.set(i,e.data.index,{id:e.data.id,order_id:t,type:e.data.type,index:e.data.index}),uni.setStorageSync("b2_guest_buy_"+e.data.id+"_"+e.data.type,i)}uni.showModal({title:"购买成功！",content:a.payData.cart?"您可以查看订单，或者继续逛逛":"返回商品页查看购买结果",cancelText:a.payData.cart?"查看订单":"",confirmText:a.payData.cart?"继续逛逛":"返回商品",showCancel:!!a.payData.cart,success:function(t){if(t.confirm){if(a.$store.state.reflash=!0,"circle_hidden_content_pay"==a.payData.order_type&&(a.$store.state.reflashTopic=a.payData.index),"infomation_sticky"==a.payData.order_type)return void a.goback();a.go(uni.getStorageSync("historyUrl").replace(/\"/g,""))}else a.go("/pages/my/index")}})}else a.timeOut=setTimeout((function(){a.payCheck(t)}),1e3)}})},goShopPage:function(){},pay:function(){this.buildOrder()},radioChange:function(t){this.picked=t.detail.value},getAllowPay:function(){var t=this;this.locked=!0,uni.request({method:"post",url:this.$store.state.restUrlNormal+"allowPayType",header:this.$store.state.headerToken,data:{show_type:this.payData.order_type},success:function(a){"circle_join"==t.payData.order_type&&(t.type="加入"+t.$store.state.opt.mNames.circle_name),t.allowPay=a.data,1==a.data.balance&&"cz"!=t.payData.order_type&&a.data.money>=t.payData.order_price?t.picked="balance":1==a.data.wecatpay?t.picked="wecatpay":1==a.data.alipay?t.picked="alipay":1==a.data.paypal&&(t.picked="paypal"),t.locked=!1}})},savePayOpenId:function(){},timeRow:function(){var t=new Date((new Date).getTime()+18e5);this.timeAction(t)},timeAction:function(t){var a=this,e=setTimeout((function(){var i=new Date;i>=t?(a.time,clearTimeout(e)):(a.time=a.getInterval(i,t),a.timeAction(t))}),1e3)}}};a.default=i}).call(this,e("5a52")["default"])}}]);